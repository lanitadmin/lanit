<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.20" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.5.1.v20090903 Build &lt;2.5.1.v20090917-1447></property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="layoutPreference">fixed layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <parameters>
        <scalar-parameter name="checkPeriod" id="79">
            <property name="hidden">false</property>
            <text-property name="promptText">Выберите период, за который необходимо выпустить отчет</text-property>
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">checkYear</value>
            </simple-property-list>
            <list-property name="selectionList">
                <structure>
                    <property name="value">checkYear</property>
                    <property name="label">Год</property>
                </structure>
                <structure>
                    <property name="value">checkQuart</property>
                    <property name="label">Квартал</property>
                </structure>
                <structure>
                    <property name="value">checkMonth</property>
                    <property name="label">Месяц</property>
                </structure>
                <structure>
                    <property name="value">checkDay</property>
                    <property name="label">Сутки</property>
                </structure>
                <structure>
                    <property name="value">checkRandom</property>
                    <property name="label">Произвольный период</property>
                </structure>
            </list-property>
            <property name="paramType">simple</property>
            <property name="controlType">list-box</property>
            <property name="mustMatch">true</property>
            <property name="fixedOrder">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <parameter-group name="period" id="140">
            <text-property name="displayName">Выбор фиксированного периода для отчета:</text-property>
            <parameters>
                <scalar-parameter name="comboYear" id="80">
                    <property name="hidden">false</property>
                    <text-property name="promptText">Выберите год (если отчет требуется вывести за год, за квартал, за месяц или за сутки)</text-property>
                    <property name="valueType">dynamic</property>
                    <property name="isRequired">true</property>
                    <property name="dataSetName">GetYear_DataSet</property>
                    <expression name="valueExpr" type="javascript">dataSetRow["YEARS"]</expression>
                    <expression name="sortByColumn">dataSetRow["YEARS"]</expression>
                    <property name="sortDirection">desc</property>
                    <property name="dataType">integer</property>
                    <property name="distinct">true</property>
                    <simple-property-list name="defaultValue">
                        <value type="constant">2011</value>
                    </simple-property-list>
                    <property name="paramType">simple</property>
                    <property name="controlType">list-box</property>
                    <property name="alignment">auto</property>
                    <property name="mustMatch">true</property>
                    <property name="fixedOrder">false</property>
                    <structure name="format">
                        <property name="category">Unformatted</property>
                    </structure>
                </scalar-parameter>
                <scalar-parameter name="comboQuart" id="83">
                    <property name="hidden">false</property>
                    <text-property name="promptText">Выберите квартал (если отчет требуется вывести за квартал)</text-property>
                    <property name="valueType">static</property>
                    <property name="isRequired">true</property>
                    <property name="dataType">string</property>
                    <property name="distinct">true</property>
                    <simple-property-list name="defaultValue">
                        <value type="constant">1</value>
                    </simple-property-list>
                    <list-property name="selectionList">
                        <structure>
                            <property name="value">1</property>
                            <property name="label">1</property>
                        </structure>
                        <structure>
                            <property name="value">2</property>
                            <property name="label">2</property>
                        </structure>
                        <structure>
                            <property name="value">3</property>
                            <property name="label">3</property>
                        </structure>
                        <structure>
                            <property name="value">4</property>
                            <property name="label">4</property>
                        </structure>
                    </list-property>
                    <property name="paramType">simple</property>
                    <property name="controlType">list-box</property>
                    <property name="mustMatch">true</property>
                    <property name="fixedOrder">true</property>
                    <structure name="format">
                        <property name="category">Unformatted</property>
                    </structure>
                </scalar-parameter>
                <scalar-parameter name="comboDate" id="81">
                    <property name="hidden">false</property>
                    <text-property name="promptText">Выберите число (если отчет требуется вывести за конкретные сутки)</text-property>
                    <property name="valueType">static</property>
                    <property name="isRequired">true</property>
                    <property name="dataType">string</property>
                    <property name="distinct">true</property>
                    <simple-property-list name="defaultValue">
                        <value type="constant">01</value>
                    </simple-property-list>
                    <list-property name="selectionList">
                        <structure>
                            <property name="value">01</property>
                            <property name="label">01</property>
                        </structure>
                        <structure>
                            <property name="value">02</property>
                            <property name="label">02</property>
                        </structure>
                        <structure>
                            <property name="value">03</property>
                            <property name="label">03</property>
                        </structure>
                        <structure>
                            <property name="value">04</property>
                            <property name="label">04</property>
                        </structure>
                        <structure>
                            <property name="value">05</property>
                            <property name="label">05</property>
                        </structure>
                        <structure>
                            <property name="value">06</property>
                            <property name="label">06</property>
                        </structure>
                        <structure>
                            <property name="value">07</property>
                            <property name="label">07</property>
                        </structure>
                        <structure>
                            <property name="value">08</property>
                            <property name="label">08</property>
                        </structure>
                        <structure>
                            <property name="value">09</property>
                            <property name="label">09</property>
                        </structure>
                        <structure>
                            <property name="value">10</property>
                            <property name="label">10</property>
                        </structure>
                        <structure>
                            <property name="value">11</property>
                            <property name="label">11</property>
                        </structure>
                        <structure>
                            <property name="value">12</property>
                            <property name="label">12</property>
                        </structure>
                        <structure>
                            <property name="value">13</property>
                            <property name="label">13</property>
                        </structure>
                        <structure>
                            <property name="value">14</property>
                            <property name="label">14</property>
                        </structure>
                        <structure>
                            <property name="value">15</property>
                            <property name="label">15</property>
                        </structure>
                        <structure>
                            <property name="value">16</property>
                            <property name="label">16</property>
                        </structure>
                        <structure>
                            <property name="value">17</property>
                            <property name="label">17</property>
                        </structure>
                        <structure>
                            <property name="value">18</property>
                            <property name="label">18</property>
                        </structure>
                        <structure>
                            <property name="value">19</property>
                            <property name="label">19</property>
                        </structure>
                        <structure>
                            <property name="value">20</property>
                            <property name="label">20</property>
                        </structure>
                        <structure>
                            <property name="value">21</property>
                            <property name="label">21</property>
                        </structure>
                        <structure>
                            <property name="value">22</property>
                            <property name="label">22</property>
                        </structure>
                        <structure>
                            <property name="value">23</property>
                            <property name="label">23</property>
                        </structure>
                        <structure>
                            <property name="value">24</property>
                            <property name="label">24</property>
                        </structure>
                        <structure>
                            <property name="value">25</property>
                            <property name="label">25</property>
                        </structure>
                        <structure>
                            <property name="value">26</property>
                            <property name="label">26</property>
                        </structure>
                        <structure>
                            <property name="value">27</property>
                            <property name="label">27</property>
                        </structure>
                        <structure>
                            <property name="value">28</property>
                            <property name="label">28</property>
                        </structure>
                        <structure>
                            <property name="value">29</property>
                            <property name="label">29</property>
                        </structure>
                        <structure>
                            <property name="value">30</property>
                            <property name="label">30</property>
                        </structure>
                        <structure>
                            <property name="value">31</property>
                            <property name="label">31</property>
                        </structure>
                    </list-property>
                    <property name="paramType">simple</property>
                    <property name="controlType">list-box</property>
                    <property name="mustMatch">true</property>
                    <property name="fixedOrder">true</property>
                    <structure name="format">
                        <property name="category">Unformatted</property>
                    </structure>
                </scalar-parameter>
                <scalar-parameter name="comboMonth" id="82">
                    <property name="hidden">false</property>
                    <text-property name="promptText">Выберите месяц (если отчет требуется вывести за месяц или за сутки)</text-property>
                    <property name="valueType">static</property>
                    <property name="isRequired">true</property>
                    <property name="dataType">string</property>
                    <property name="distinct">true</property>
                    <simple-property-list name="defaultValue">
                        <value type="constant">01</value>
                    </simple-property-list>
                    <list-property name="selectionList">
                        <structure>
                            <property name="value">01</property>
                            <property name="label">Январь</property>
                        </structure>
                        <structure>
                            <property name="value">02</property>
                            <property name="label">Февраль</property>
                        </structure>
                        <structure>
                            <property name="value">03</property>
                            <property name="label">Март</property>
                        </structure>
                        <structure>
                            <property name="value">04</property>
                            <property name="label">Апрель</property>
                        </structure>
                        <structure>
                            <property name="value">05</property>
                            <property name="label">Май</property>
                        </structure>
                        <structure>
                            <property name="value">06</property>
                            <property name="label">Июнь</property>
                        </structure>
                        <structure>
                            <property name="value">07</property>
                            <property name="label">Июль</property>
                        </structure>
                        <structure>
                            <property name="value">08</property>
                            <property name="label">Август</property>
                        </structure>
                        <structure>
                            <property name="value">09</property>
                            <property name="label">Сентябрь</property>
                        </structure>
                        <structure>
                            <property name="value">10</property>
                            <property name="label">Октябрь</property>
                        </structure>
                        <structure>
                            <property name="value">11</property>
                            <property name="label">Ноябрь</property>
                        </structure>
                        <structure>
                            <property name="value">12</property>
                            <property name="label">Декабрь</property>
                        </structure>
                    </list-property>
                    <property name="paramType">simple</property>
                    <property name="controlType">list-box</property>
                    <property name="mustMatch">true</property>
                    <property name="fixedOrder">true</property>
                    <structure name="format">
                        <property name="category">Unformatted</property>
                    </structure>
                </scalar-parameter>
            </parameters>
        </parameter-group>
        <parameter-group name="randomPeriod" id="141">
            <text-property name="displayName">Ввод произвольного периода:</text-property>
            <parameters>
                <scalar-parameter name="randomStartDate" id="138">
                    <text-property name="helpText">Введите дату</text-property>
                    <text-property name="promptText">Введите начало периода в формате ДД.ММ.ГГГГ</text-property>
                    <property name="valueType">static</property>
                    <property name="dataType">string</property>
                    <property name="distinct">true</property>
                    <simple-property-list name="defaultValue">
                        <value type="constant">01.01.2000</value>
                    </simple-property-list>
                    <property name="paramType">simple</property>
                    <property name="controlType">text-box</property>
                    <structure name="format">
                        <property name="category">Unformatted</property>
                    </structure>
                </scalar-parameter>
                <scalar-parameter name="randomEndDate" id="139">
                    <text-property name="promptText">Введите конец периода в формате ДД.ММ.ГГГГ</text-property>
                    <property name="valueType">static</property>
                    <property name="dataType">string</property>
                    <property name="distinct">true</property>
                    <simple-property-list name="defaultValue">
                        <value type="constant">01.01.2000</value>
                    </simple-property-list>
                    <property name="paramType">simple</property>
                    <property name="concealValue">false</property>
                    <property name="controlType">text-box</property>
                    <structure name="format">
                        <property name="category">Unformatted</property>
                    </structure>
                </scalar-parameter>
            </parameters>
        </parameter-group>
    </parameters>
    <data-sources>
        <script-data-source name="Data Source" id="42"/>
    </data-sources>
    <data-sets>
        <script-data-set name="Data Set" id="43">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">SERVICE</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">GET_DOC</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">OPERATOR</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">avgTIME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">TIME</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">SUM_OPER_TIME_MILLS</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">SERVICE</property>
                </structure>
                <structure>
                    <property name="columnName">GET_DOC</property>
                </structure>
                <structure>
                    <property name="columnName">OPERATOR</property>
                </structure>
                <structure>
                    <property name="columnName">avgTIME</property>
                </structure>
                <structure>
                    <property name="columnName">TIME</property>
                </structure>
                <structure>
                    <property name="columnName">SUM_OPER_TIME_MILLS</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">SERVICE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">GET_DOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">OPERATOR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">avgTIME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">TIME</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">SUM_OPER_TIME_MILLS</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[clazz = new Packages.org.cp.birt.plugins.Shark();
clazzConvert = new Packages.org.cp.birt.plugins.Converter();

//---ФОРМИРУЕМ НАЧАЛЬНУЮ И КОНЕЧНУЮ ДАТУ, ЗА КОТОРЫЙ ВЫВОДИТСЯ ОТЧЕТ---/
if (params["checkPeriod"] != "checkRandom"){					//Если отчет НЕ за произвольный период
	if (params["checkPeriod"] == "checkDay"){					//Если отчет за DAY
		startDay 	= params["comboDate"];
		startMonth 	= params["comboMonth"];
		startYear 	= params["comboYear"];
		endDay 		= startDay;
		endMonth 	= startMonth;
		endYear 	= startYear;
	}
	if (params["checkPeriod"] == "checkMonth"){					//Если отчет за MONTH
		startDay = "01";
		if (params["comboMonth"] == 1 ||						//месяц с 31-м днем 
			params["comboMonth"] == 3 || 
			params["comboMonth"] == 5 || 
			params["comboMonth"] == 7 || 
			params["comboMonth"] == 8 || 
			params["comboMonth"] == 10 || 
			params["comboMonth"] == 12 )
			endDay = "31";
		else
		if (params["comboMonth"] == 2) {						//Февраль?
			if (params["comboYear"] % 4 == 0 &amp;&amp; 				//Високосный год?
				params["comboYear"] % 100 != 0 || 
				params["comboYear"] % 400 == 0)
				endDay = "29";
			else												//Невисокосный год
				endDay = "28";
		}
		else													//Остальные месяца (с 30-ю днями)
			endDay = "30";
		startMonth = params["comboMonth"];
		endMonth = startMonth;
		startYear = params["comboYear"];
		endYear = startYear;
	}
	if (params["checkPeriod"] == "checkQuart") {				//Если отчет за QUART
		startDay = "01";
		startYear = params["comboYear"];
		endYear = startYear;
		if (params["comboQuart"] == "1") {						//1-ый квартал
			startMonth = "01";
			endMonth = "03";
			endDay = "31";
		}
		else
		if (params["comboQuart"] == "2") {						//2-ой квартал
			startMonth = "04";
			endMonth = "06";
			endDay = "30";
		}
		else
		if (params["comboQuart"] == "3") {						//3-ий квартал
			startMonth = "07";
			endMonth = "09";
			endDay = "30";
		}
		else
		if (params["comboQuart"] == "4") {						//4-ый квартал
			startMonth = "10";
			endMonth = "12";
			endDay = "31";
		}
	}
	if (params["checkPeriod"] == "checkYear") {					//Если отчет за YEAR
		startYear = params["comboYear"];
		endYear = startYear;
		startDay = "01";
		endDay = "31";
		startMonth = "01";
		endMonth = "12";
	}
	startDate = startDay + "." + startMonth + "." + startYear;	//Формируется начальная дата
	startDate = clazzConvert.getLongDate(startDate);
	endDate = endDay + "." + endMonth + "." + endYear;			//Формируется конечная дата
	endDate = clazzConvert.getLongDate(endDate);
}
else{															//Если отчет за произвольный период
	startDate = clazzConvert.getLongDate(params["randomStartDate"]);;	//Формируется начальная дата
	endDate = clazzConvert.getLongDate(params["randomEndDate"]);//Формируется конечная дата
}

//------ФОРМИРУЕМ НАБОР ДАННЫХ (услуги и операторы)------//
result = clazz.getEntityManagerShark().createQuery
(
	" select "+//distinct"+
		" a1.resourceUsername as UserLogin, "+
		" av1Serv.stringValue as SERVICE_ID, "+
		" a1.processId, "+
		" (a2.lastStateTime - a1.activatedTime) "+
	" from "+
		" ActivityEntity a1, "+
		" ActivityEntity a2, "+
		" ActivityVariableEntity av1Serv, "+
		" ActivityVariableEntity av1Guid, "+
		" ActivityVariableEntity av2Guid "+
	" where "+
		" a1.activityDefinitionId = 'Reg_lichno_act3' and "+
		" a2.activityDefinitionId = 'Priem_act31' and "+
		" a1.state = 'closed.completed' and "+
		" a2.state = 'closed.completed' and "+
		" a1.id = av1Serv.activityId and "+
		" av1Serv.definitionId = 'Service' and "+
		" a1.id = av1Guid.activityId and "+
		" a2.id = av2Guid.activityId and "+
		" av1Guid.definitionId = 'GUID' and "+
		" av2Guid.definitionId = 'GUID' and "+
		//" a1.id = (select max(a1.id)) and "+
		" av1Guid.longValue = av2Guid.longValue and "+
		//" a2.acceptedTime >='"+startDate+"' and "+
		//" a2.acceptedTime <='"+endDate+"'"
		" a1.acceptedTime >='"+startDate+"' and "+ 	//не забыть заменить
		" a1.acceptedTime <='"+endDate+"'"			//не забыть заменить
)
.getResultList();

currentrow = 0;
totalrows = result.size();]]></method>
            <method name="fetch"><![CDATA[if (currentrow >= totalrows) {
	return(false);
}
var rowValue = result.get(currentrow);

//-----функция получения наименования услуги-----//
function getServName(servId){
try{
	servName = clazz.getEntityManagerLod().createQuery(
		" select "+
			" ce.name as SERVICE "+
		" from "+
			" CardElement ce "+
		" where "+
			" ce.card.cardCode = 'SService' and "+
			" ce.id = :servId "
	)
	.setParameter("servId", servId)
	.getSingleResult();
}
catch (e){
	servName = "[Not_Found]";
}
if (servName == "[]") 
	servName = "[Not_Found]"; 
return servName;
}
//-----функция получения ФИО оператора-----//
function getUserFIO(userLogin){
try{
	userFIO = clazz.getEntityManagerLod().createQuery(
		" select "+
			" u.lastName || ' ' || substring(u.firstName,1,1) || '.' || substring(u.middleName,1,1) || '.' "+
		" from "+
			" User as u "+
		" where "+
			" u.login = :userLogin "
	)
	.setParameter("userLogin", userLogin)
	.getSingleResult();
}
catch (e){
	userFIO = "[Not_Found]";
}
if (userFIO == "[]") 
	userFIO = "[Not_Found]"; 
return userFIO;
}

//-----функция получения потраченного времени и среднего времени в формате ЧЧ:ММ:СС-----//
function getHumanTime(millsTime){
    /* 1 000 ms = 1 sec       *
     * 60 000 ms = 1 min      *
     * 3600 000 ms = 1 h      */
	hh = parseInt(millsTime / 3600000);
	mm = parseInt(millsTime % 3600000 / 60000);
	ss = parseInt(millsTime % 60000 / 1000);
	//ss = Math.ceil(millsTime % 60000 / 1000);
	//ss = Math.round(millsTime % 60000 / 1000);
    if (hh < 10)
    	hh = "0" + hh;
    if (mm < 10)
    	mm = "0" + mm;
    if (ss < 10)
    	ss = "0" + ss;
    humanTime = hh + ":" + mm + ":" + ss; 
return humanTime;
}

//---------------вывод услуги в отчет-------------------//
resultServName = getServName(rowValue[1]);
if (!resultServName.equals("[Not_Found]")){			//|| !resultServName.equals("") || resultServName != null){
	resultServName = String(resultServName);		//Перерводим из Object в String
	resultServName = resultServName.replace("[","")	//И убираем [ ], чтобы красиво выводилось
	resultServName = resultServName.replace("]","")  
	row["SERVICE"] = resultServName;
}
else
	row["SERVICE"] = "Услуга удалена"+ currentrow;

//---------------вывод ФИО ОПЕРАТОРА в отчет-----------//
resultUserFIO = getUserFIO(rowValue[0]);
if (!resultUserFIO.equals("[Not_Found]")){			//|| !resultServName.equals("") || resultServName != null){
	resultUserFIO = String(resultUserFIO);			//Перерводим из Object в String
	resultUserFIO = resultUserFIO.replace("[","")	//И убираем [ ], чтобы красиво выводилось
	resultUserFIO = resultUserFIO.replace("]","")  
	row["OPERATOR"] = resultUserFIO;
}
else
	row["OPERATOR"] = "Учетная запись удалена";

//---------------вывод кол-ва принятых дел------------------------------------//
row["GET_DOC"] = rowValue[2];

//---------------вывод времени, потраченного на прием документов--------------//
row["TIME"] = rowValue[3];

//---------------вывод среднего времени, потраченного на прием документов----//
//avgTimeDoc = resultTimeDoc/resultCountDoc;
//row["avgTIME"] = getHumanTime(avgTimeDoc);

//****************************************************************************************************************************************************//
currentrow = currentrow + 1;
return(true);]]></method>
            <method name="close"><![CDATA[clazz = null;
result = null;
clazzConvert = null;]]></method>
        </script-data-set>
        <script-data-set name="GetYear_DataSet" id="131">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">YEARS</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">YEARS</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">YEARS</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <method name="afterClose"><![CDATA[	]]></method>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[currentYear = BirtDateTime.year(new Date());
countYears = 1;
currentrow = 1;
totalrows = 10;]]></method>
            <method name="fetch"><![CDATA[if (currentrow >= totalrows) {
	return(false);
}

countYears = countYears+1;
years = (currentYear-10 + countYears);
row["YEARS"] = years;

currentrow = currentrow + 1;
return(true);]]></method>
        </script-data-set>
        <script-data-set name="Date_DataSet" id="302">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">0</property>
                    <property name="name">PERIOD</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">PERIOD</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">PERIOD</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <method name="open"><![CDATA[clazz = new Packages.org.cp.birt.plugins.Converter();
if (params["checkPeriod"] == "checkRandom")
	resultDate = clazz.dateIsValid(params["randomStartDate"],params["randomEndDate"]);
totalrows = 1;
currentrow = 0;]]></method>
            <method name="fetch"><![CDATA[if (currentrow >= totalrows) {
	return(false);
}
//****************************************************************************************************************************************************//
//---ФОРМИРУЕМ ВЫВОД НАЗВАНИЯ ВЫБРАННОГО ПЕРИОДА---//
if (params["checkPeriod"] == "checkRandom"){
	if (resultDate == 1)
		row["PERIOD"] = params["randomStartDate"] + " г. - " + params["randomEndDate"] + " г.";
	else
		row["PERIOD"] = "(Неверно введен период)";
}
else{
	if (params["checkPeriod"] == "checkDay") {				//Если выбран за день
		switch (params["comboMonth"].value)					//Месяц в родительном падеже
		{
			case "01": promptMonth = "января";break;
			case "02": promptMonth = "февраля";break;
			case "03": promptMonth = "марта";break;
			case "04": promptMonth = "апреля";break;
			case "05": promptMonth = "мая";break;
			case "06": promptMonth = "июня";break;
			case "07": promptMonth = "июля";break;
			case "08": promptMonth = "августа";break;
			case "09": promptMonth = "сентября";break;
			case "10": promptMonth = "октября";break;
			case "11": promptMonth = "ноября";break;
			case "12": promptMonth = "декабря";break;
		}
		row["PERIOD"] = params["comboDate"] + " " + promptMonth + " " + params["comboYear"] + " года";	//заполняем период - "ДД месяца ГГГГ года"
	}
	if (params["checkPeriod"] == "checkMonth") {			//Если выбран за месяц
		switch (params["comboMonth"].value)					//Месяц в именительном падеже
		{
			case "01": promptMonth = "январь";break;
			case "02": promptMonth = "февраль";break;
			case "03": promptMonth = "март";break;
			case "04": promptMonth = "апрель";break;
			case "05": promptMonth = "май";break;
			case "06": promptMonth = "июнь";break;
			case "07": promptMonth = "июль";break;
			case "08": promptMonth = "август";break;
			case "09": promptMonth = "сентябрь";break;
			case "10": promptMonth = "октябрь";break;
			case "11": promptMonth = "ноябрь";break;
			case "12": promptMonth = "декабрь";break;
		}
		row["PERIOD"] = promptMonth + " " + params["comboYear"] + " года"	//заполняем период - "месяц ГГГГ года"
	}
	if (params["checkPeriod"] == "checkQuart")				//Если выбран за квартал
		row["PERIOD"] = params["comboQuart"] + " квартал  " + params["comboYear"] + " года"	//заполняем период - "№ квартал ГГГГ года"
	if (params["checkPeriod"] == "checkYear")				//Если выбран год
		row["PERIOD"] = params["comboYear"] + " год"		//заполняем период - "ГГГГ год"
	}

currentrow = currentrow + 1;
return(true);]]></method>
            <method name="close"><![CDATA[clazz = null;]]></method>
        </script-data-set>
    </data-sets>
    <styles>
        <style name="report" id="4">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">10pt</property>
        </style>
        <style name="crosstab-cell" id="5">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="crosstab" id="6">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <property name="orientation">portrait</property>
            <property name="topMargin">2cm</property>
            <property name="leftMargin">3cm</property>
            <property name="bottomMargin">1.27cm</property>
            <property name="rightMargin">1.5cm</property>
        </simple-master-page>
    </page-setup>
    <body>
        <table id="148">
            <property name="fontFamily">"Roman Unicode"</property>
            <property name="verticalAlign">middle</property>
            <property name="dataSet">Data Set</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">SERVICE</property>
                    <expression name="expression">dataSetRow["SERVICE"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">GET_DOC</property>
                    <expression name="expression">dataSetRow["GET_DOC"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">OPERATOR</property>
                    <expression name="expression">dataSetRow["OPERATOR"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">avgTIME</property>
                    <expression name="expression">dataSetRow["avgTIME"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">TIME</property>
                    <expression name="expression" type="javascript">dataSetRow["TIME"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">SUM_OPER_TIME_MILLS</property>
                    <expression name="expression">dataSetRow["SUM_OPER_TIME_MILLS"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Ag_Count_Del</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>SERVICE_GROUP</value>
                    </simple-property-list>
                    <property name="aggregateFunction">COUNT</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["GET_DOC"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Ag_Sum_Del</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>OPERATOR_GROUP</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["Ag_Count_Del"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Ag_Sum_Time_Oper</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>OPERATOR_GROUP</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["TIME"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Ag_Sum_Del_MFC</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["Ag_Sum_Del"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Ag_Sum_Time_MFC</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["Ag_Sum_Time_Oper"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Ag_Avg_Time_Oper</property>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>OPERATOR_GROUP</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">row["TIME"]/row["GET_DOC"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression" type="javascript">row["Ag_Sum_Time_Oper"]/row["Ag_Count_Del"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_1</property>
                    <expression name="expression" type="javascript">row["Ag_Sum_Time_MFC"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_2</property>
                    <expression name="expression" type="javascript">row["TIME"]/row["Ag_Count_Del"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_3</property>
                    <expression name="expression" type="javascript">row["Column Binding_4"]/row["Ag_Sum_Del"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_4</property>
                    <expression name="expression" type="javascript">row["Ag_Sum_Time_Oper"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_5</property>
                    <expression name="expression" type="javascript">row["Ag_Sum_Time_MFC"]/row["Ag_Sum_Del_MFC"]</expression>
                    <property name="dataType">float</property>
                </structure>
            </list-property>
            <property name="pageBreakInterval">400</property>
            <column id="158">
                <property name="width">19%</property>
            </column>
            <column id="159">
                <property name="width">45%</property>
            </column>
            <column id="233">
                <property name="width">12%</property>
            </column>
            <column id="336">
                <property name="width">12%</property>
            </column>
            <column id="241">
                <property name="width">12%</property>
            </column>
            <column id="170">
                <property name="width">12%</property>
            </column>
            <column id="327">
                <property name="width">12%</property>
            </column>
            <header>
                <row id="214">
                    <property name="borderBottomColor">#000000</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">1px</property>
                    <property name="borderLeftColor">#000000</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">1px</property>
                    <property name="borderRightColor">#000000</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">1px</property>
                    <property name="borderTopColor">#000000</property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">1px</property>
                    <cell id="215">
                        <property name="colSpan">6</property>
                        <property name="rowSpan">1</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">1px</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">1px</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">1px</property>
                        <text id="78">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="verticalAlign">middle</property>
                            <property name="dataSet">Date_DataSet</property>
                            <list-property name="boundDataColumns">
                                <structure>
                                    <property name="name">PERIOD</property>
                                    <expression name="expression">dataSetRow["PERIOD"]</expression>
                                    <property name="dataType">string</property>
                                </structure>
                            </list-property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Статистика работы операторов МФЦ за <VALUE-OF>row["PERIOD"]</VALUE-OF>]]></text-property>
                        </text>
                    </cell>
                    <cell id="319">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">1px</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">1px</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">1px</property>
                    </cell>
                </row>
                <row id="149">
                    <property name="borderBottomColor">#000000</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">1px</property>
                    <property name="borderLeftColor">#000000</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">1px</property>
                    <property name="borderRightColor">#000000</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">1px</property>
                    <property name="borderTopColor">#000000</property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">1px</property>
                    <property name="verticalAlign">middle</property>
                    <cell id="150">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                        <text id="163">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Ф.И.О.]]></text-property>
                        </text>
                    </cell>
                    <cell id="151">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                        <text id="164">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Услуга]]></text-property>
                        </text>
                    </cell>
                    <cell id="227">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="242">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Принято дел]]></text-property>
                        </text>
                    </cell>
                    <cell id="329">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="337">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Потрачено времени mills]]></text-property>
                        </text>
                    </cell>
                    <cell id="235">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="243">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Потрачено времени]]></text-property>
                        </text>
                    </cell>
                    <cell id="168">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="171">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Среднее время на 1 дело mills]]></text-property>
                        </text>
                    </cell>
                    <cell id="320">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="340">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">11pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Среднее время на 1 дело]]></text-property>
                        </text>
                    </cell>
                </row>
            </header>
            <group id="176">
                <property name="groupName">OPERATOR_GROUP</property>
                <property name="interval">none</property>
                <property name="sortDirection">asc</property>
                <expression name="keyExpr" type="javascript">row["OPERATOR"]</expression>
                <structure name="toc">
                    <expression name="expressionValue" type="javascript">row["OPERATOR"]</expression>
                </structure>
                <property name="repeatHeader">true</property>
                <property name="hideDetail">false</property>
                <property name="pageBreakAfter">auto</property>
                <property name="pageBreakBefore">auto</property>
                <property name="pageBreakInside">auto</property>
                <list-property name="sort">
                    <structure>
                        <expression name="key" type="javascript">row["OPERATOR"]</expression>
                        <property name="direction">asc</property>
                    </structure>
                </list-property>
                <header>
                    <row id="177">
                        <cell id="178">
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="verticalAlign">middle</property>
                            <data id="205">
                                <property name="fontFamily">"Roman Unicode"</property>
                                <property name="fontSize">10pt</property>
                                <property name="paddingTop">1pt</property>
                                <property name="paddingLeft">3pt</property>
                                <property name="paddingBottom">1pt</property>
                                <property name="paddingRight">3pt</property>
                                <property name="resultSetColumn">OPERATOR</property>
                            </data>
                        </cell>
                        <cell id="179">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="228">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="330">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="236">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="180">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="321">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                    </row>
                </header>
                <footer>
                    <row id="181">
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">1px</property>
                        <cell id="182">
                            <property name="colSpan">2</property>
                            <property name="rowSpan">1</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <text id="254">
                                <property name="fontFamily">"Roman Unicode"</property>
                                <property name="fontSize">10pt</property>
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="contentType">html</property>
                                <text-property name="content"><![CDATA[Итого по оператору:]]></text-property>
                            </text>
                        </cell>
                        <cell id="232">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <data id="310">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">Ag_Sum_Del</property>
                            </data>
                        </cell>
                        <cell id="334">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <data id="346">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">Column Binding_4</property>
                            </data>
                        </cell>
                        <cell id="240">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <text id="312">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <property name="contentType">html</property>
                                <text-property name="content"><![CDATA[<VALUE-OF>
hours = (new Date(row["Ag_Sum_Time_Oper"])).getHours()-3;
minutes= (new Date(row["Ag_Sum_Time_Oper"])).getMinutes();
seconds= (new Date(row["Ag_Sum_Time_Oper"])).getSeconds();
timeStr= ((hours < 10) ? "0" : "") + hours;
timeStr+= ((minutes < 10) ? ":0" : ":") + minutes;  
timeStr+= ((seconds < 10) ? ":0" : ":") + seconds;  
</VALUE-OF>

]]></text-property>
                            </text>
                        </cell>
                        <cell id="184">
                            <property name="fontWeight">bold</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="textAlign">center</property>
                            <data id="345">
                                <property name="resultSetColumn">Column Binding_3</property>
                            </data>
                        </cell>
                        <cell id="325">
                            <property name="fontWeight">bold</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="textAlign">center</property>
                            <text id="344">
                                <property name="contentType">html</property>
                                <text-property name="content"><![CDATA[<VALUE-OF>
hours = (new Date(row["Column Binding_3"])).getHours()-3;
minutes= (new Date(row["Column Binding_3"])).getMinutes();
seconds= (new Date(row["Column Binding_3"])).getSeconds();
timeStr= ((hours < 10) ? "0" : "") + hours;
timeStr+= ((minutes < 10) ? ":0" : ":") + minutes;  
timeStr+= ((seconds < 10) ? ":0" : ":") + seconds;  
</VALUE-OF>
]]></text-property>
                            </text>
                        </cell>
                    </row>
                </footer>
            </group>
            <group id="196">
                <property name="groupName">SERVICE_GROUP</property>
                <property name="interval">none</property>
                <property name="sortDirection">asc</property>
                <expression name="keyExpr" type="javascript">row["SERVICE"]</expression>
                <structure name="toc"/>
                <property name="repeatHeader">true</property>
                <property name="hideDetail">false</property>
                <property name="pageBreakAfter">auto</property>
                <property name="pageBreakBefore">auto</property>
                <property name="pageBreakInside">auto</property>
                <list-property name="sort">
                    <structure>
                        <expression name="key" type="javascript">row["SERVICE"]</expression>
                        <property name="direction">asc</property>
                    </structure>
                </list-property>
                <header>
                    <row id="197">
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">1px</property>
                        <cell id="198">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="199">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="verticalAlign">middle</property>
                            <data id="185">
                                <property name="fontFamily">"Roman Unicode"</property>
                                <property name="fontSize">10pt</property>
                                <property name="paddingLeft">3pt</property>
                                <property name="paddingRight">3pt</property>
                                <list-property name="mapRules">
                                    <structure>
                                        <expression name="testExpr" type="javascript">row["SERVICE"]</expression>
                                        <property name="operator">like</property>
                                        <simple-property-list name="value1">
                                            <value>'Услуга удалена'</value>
                                        </simple-property-list>
                                        <text-property name="display">Услуга удалена</text-property>
                                    </structure>
                                </list-property>
                                <property name="resultSetColumn">SERVICE</property>
                            </data>
                        </cell>
                        <cell id="229">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="verticalAlign">middle</property>
                            <data id="309">
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">Ag_Count_Del</property>
                            </data>
                        </cell>
                        <cell id="331">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="textAlign">center</property>
                            <property name="verticalAlign">middle</property>
                            <data id="318">
                                <property name="resultSetColumn">TIME</property>
                            </data>
                        </cell>
                        <cell id="237">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="textAlign">center</property>
                            <property name="verticalAlign">middle</property>
                            <text id="304">
                                <property name="textAlign">center</property>
                                <property name="contentType">html</property>
                                <text-property name="content"><![CDATA[<VALUE-OF>
hours = (new Date(row["TIME"])).getHours()-3;
minutes= (new Date(row["TIME"])).getMinutes();
seconds= (new Date(row["TIME"])).getSeconds();
timeStr= ((hours < 10) ? "0" : "") + hours;
timeStr+= ((minutes < 10) ? ":0" : ":") + minutes;  
timeStr+= ((seconds < 10) ? ":0" : ":") + seconds;  
</VALUE-OF>]]></text-property>
                            </text>
                        </cell>
                        <cell id="200">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="verticalAlign">middle</property>
                            <data id="342">
                                <property name="textAlign">center</property>
                                <property name="resultSetColumn">Column Binding_2</property>
                            </data>
                        </cell>
                        <cell id="322">
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="verticalAlign">middle</property>
                            <text id="343">
                                <property name="textAlign">center</property>
                                <property name="contentType">html</property>
                                <text-property name="content"><![CDATA[<VALUE-OF>
hours = (new Date(row["Column Binding_2"])).getHours()-3;
minutes= (new Date(row["Column Binding_2"])).getMinutes();
seconds= (new Date(row["Column Binding_2"])).getSeconds();
timeStr= ((hours < 10) ? "0" : "") + hours;
timeStr+= ((minutes < 10) ? ":0" : ":") + minutes;  
timeStr+= ((seconds < 10) ? ":0" : ":") + seconds;  
</VALUE-OF>


]]></text-property>
                            </text>
                        </cell>
                    </row>
                </header>
                <footer>
                    <row id="201">
                        <cell id="202">
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="203">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="231">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="333">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="239">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="204">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                        <cell id="324">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                        </cell>
                    </row>
                </footer>
            </group>
            <detail>
                <row id="206">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr" type="javascript">true</expression>
                        </structure>
                    </list-property>
                    <cell id="207">
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                    </cell>
                    <cell id="208">
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">1px</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                    </cell>
                    <cell id="230">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                    </cell>
                    <cell id="332">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                    </cell>
                    <cell id="238">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                    </cell>
                    <cell id="209">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                    </cell>
                    <cell id="323">
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="248">
                    <property name="fontSize">12pt</property>
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr" type="javascript">count = Math.max(row.__rownum);
count &lt; 0;</expression>
                        </structure>
                    </list-property>
                    <cell id="249">
                        <property name="colSpan">2</property>
                        <property name="rowSpan">1</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <text id="264">
                            <property name="fontFamily">"Roman Unicode"</property>
                            <property name="fontSize">12pt</property>
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[Итого по МФЦ:]]></text-property>
                        </text>
                    </cell>
                    <cell id="251">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="313">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">Ag_Sum_Del_MFC</property>
                        </data>
                    </cell>
                    <cell id="335">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="339">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">Column Binding_1</property>
                        </data>
                    </cell>
                    <cell id="252">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="315">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[<VALUE-OF>
hours = (new Date(row["Ag_Sum_Time_MFC"])).getHours()-3;
minutes= (new Date(row["Ag_Sum_Time_MFC"])).getMinutes();
seconds= (new Date(row["Ag_Sum_Time_MFC"])).getSeconds();
timeStr= ((hours < 10) ? "0" : "") + hours;
timeStr+= ((minutes < 10) ? ":0" : ":") + minutes;  
timeStr+= ((seconds < 10) ? ":0" : ":") + seconds;  
</VALUE-OF>]]></text-property>
                        </text>
                    </cell>
                    <cell id="253">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="348">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="resultSetColumn">Column Binding_5</property>
                        </data>
                    </cell>
                    <cell id="326">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <text id="349">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">center</property>
                            <property name="contentType">html</property>
                            <text-property name="content"><![CDATA[<VALUE-OF>
hours = (new Date(row["Column Binding_5"])).getHours()-3;
minutes= (new Date(row["Column Binding_5"])).getMinutes();
seconds= (new Date(row["Column Binding_5"])).getSeconds();
timeStr= ((hours < 10) ? "0" : "") + hours;
timeStr+= ((minutes < 10) ? ":0" : ":") + minutes;  
timeStr+= ((seconds < 10) ? ":0" : ":") + seconds;  
</VALUE-OF>
]]></text-property>
                        </text>
                    </cell>
                </row>
            </footer>
        </table>
    </body>
</report>
